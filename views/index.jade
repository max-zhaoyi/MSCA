extends layout

block content
  h1= title
  p Welcome to #{title}

  table(class="chat-log", id="chat-log") 
    thead
      tr(class="chat-header", id="chat-header")
        th Alias
        th Time
        th Message
    tbody 
      each item in items 
        tr 
          td= item.alias 
          td= item.time 
          td= item.message
  br
  script(src="/socket.io/socket.io.js")
  script.  
    var socket = io();
    function addMessages(messages){
      console.log("here2")
      messages.forEach(message => {
        var newRow = $("#chat-log").insertRow()
        var cell1 = newRow.insertCell(0)
        var cell2 = newRow.insertCell(1)
        var cell3 = newRow.insertCell(2)
        cell1.innerHTML = message[0]
        cell2.innerHTML = message[1] 
        cell3.innerHTML = message[2]

      })
    socket.on('msglist update', addMessages)
    }
    
  form(id="chat-log", method="POST", action="/")
    label(for="user-name") Alias:
    br
    input(type="text", id="user-name", name="uname")
    br
    br
    label(for="message-input") Message:
    br
    input(type="text", id="message-input", name="minput")
    br 
    br
    input(type="submit", value="Send")